<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="AR-–≤—ñ–∑–∏—Ç–∫–∞ Smart Lessa ‚Äî –ø—Ä–æ—Å—Ç—ñ—Ä —ñ–Ω–Ω–æ–≤–∞—Ü—ñ–π–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≤–∞–≥ —á–µ—Ä–µ–∑ AR-—Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó. –û—Å–≤—ñ—Ç–Ω—ñ –∫–≤–µ—Å—Ç–∏, —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ –ø—Ä–æ—î–∫—Ç–∏, –Ω–∞–≤—á–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –≥—Ä—É.">
    <title>üé® Smart Lessa AR-–≤—ñ–∑–∏—Ç–∫–∞</title>

    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">

    <style>
        html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; touch-action: none; }
        a-scene { width: 100% !important; height: 100% !important; position: fixed; top: 0; left: 0; }
        .arjs-loader {
            height: 100%; width: 100%; position: absolute; top: 0; left: 0;
            background: rgba(135, 206, 235, 0.95); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: #FF4500; font-size: 1.8em; text-align: center; padding: 20px; box-sizing: border-box;
            font-family: 'Comic Neue', 'Comic Sans MS', cursive, sans-serif;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .pulse { animation: pulse 1.5s infinite; }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –≤—ñ–∫—Ç–æ—Ä–∏–Ω–∏ */
        .quiz-container {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            z-index: 10001; background: rgba(255, 255, 255, 0.95);
            border-radius: 15px; padding: 25px; max-width: 90%; text-align: center;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); font-family: 'Comic Neue', 'Comic Sans MS', cursive, sans-serif;
            display: none;
        }
        .quiz-question { font-size: 1.5em; margin-bottom: 20px; color: #333; }
        .quiz-options button {
            display: block; width: 100%; padding: 12px; margin-bottom: 10px;
            border: 2px solid #4CAF50; border-radius: 10px;
            background-color: #f0f0f0; cursor: pointer; font-size: 1.1em;
            transition: background-color 0.3s;
        }
        .quiz-options button:hover { background-color: #e0e0e0; }
        .quiz-options button.correct { background-color: #4CAF50; color: white; border-color: #4CAF50; }
        .quiz-options button.incorrect { background-color: #f44336; color: white; border-color: #f44336; }
        .quiz-result { margin-top: 20px; font-size: 1.3em; font-weight: bold; }

        /* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω–∞, –∑–≤–µ—Ä—Ö—É */
        .close-btn {
            position: absolute; top: 5px; right: 10px; padding: 4px 8px;
            cursor: pointer; border: none; background: #f44336; color: white;
            border-radius: 5px; font-size: 0.9em; z-index: 10;
        }

        @media (max-width: 400px) {
            .quiz-question { font-size: 1.2em; }
            .quiz-options button { font-size: 0.9em; padding: 8px; }
            .close-btn { font-size: 0.8em; padding: 3px 6px; }
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ */
        .clickable {
            cursor: pointer;
        }
        .clickable:hover {
            opacity: 0.8;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –≥–∞–ª–µ—Ä–µ—ó */
  #gallery-ui {
    position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
    z-index: 10002; background: rgba(0, 0, 0, 0.7); padding: 15px; border-radius: 12px;
    display: none; color: white; text-align: center; font-family: 'Comic Neue', sans-serif;
    max-width: 90%; /* –†–æ–∑—à–∏—Ä–µ–Ω–æ –¥–æ 90% */
    min-width: 300px; /* –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —à–∏—Ä–∏–Ω–∞ */
    min-height: 350px; /* –í–∏–¥–æ–≤–∂–µ–Ω–æ –¥–æ 350px */
    pointer-events: auto;
}
#gallery-ui .counter {
    font-size: 1.2em; margin-bottom: 10px;
}
#gallery-ui .nav {
    display: flex; justify-content: center; gap: 15px; margin-top: 10px;
}
#gallery-ui button {
    background: rgba(255, 255, 255, 0.2); color: white; border: none;
    border-radius: 50%; width: 40px; height: 40px; font-size: 1.3em; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
}
#gallery-ui .close-btn {
    position: absolute; top: 5px; right: 10px; padding: 3px 8px; font-size: 0.9em;
}
#gallery-img {
    max-width: 100%; max-height: 80vh; /* –ó–±—ñ–ª—å—à–µ–Ω–æ –≤–∏—Å–æ—Ç—É –∑ 60vh –¥–æ 80vh */
    border-radius: 8px; display: block; margin: 10px auto;
}
    </style>
</head>
<body>
    <div class="arjs-loader" id="loader">
        <div class="pulse">‚ú® Smart Lessa AR-–≤—ñ–∑–∏—Ç–∫–∞ ‚ú®</div>
        <div style="margin-top: 20px; font-size: 1.2em;">–ù–∞–≤–µ–¥—ñ—Ç—å –∫–∞–º–µ—Ä—É –Ω–∞ –≤—ñ–∑–∏—Ç–∫—É! üòä</div>
    </div>

    <!-- –í—ñ–∫—Ç–æ—Ä–∏–Ω–∞ -->
    <div id="quiz-container" class="quiz-container">
        <button class="close-btn" id="close-quiz" aria-label="–ó–∞–∫—Ä–∏—Ç–∏ –≤—ñ–∫—Ç–æ—Ä–∏–Ω—É">‚úñ</button>
        <div class="quiz-question" id="quiz-question"></div>
        <div class="quiz-options" id="quiz-options"></div>
        <div class="quiz-result" id="quiz-result"></div>
    </div>

    <!-- UI –¥–ª—è –≥–∞–ª–µ—Ä–µ—ó -->
    <div id="gallery-ui">
        <button class="close-btn" id="close-gallery-ui">‚úñ</button>
        <div class="counter" id="gallery-counter">–§–æ—Ç–æ 1 –∑ 4</div>
        <img id="gallery-img" src="" alt="–ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ" style="max-width: 100%; max-height: 60vh; border-radius: 8px; display: block; margin: 10px auto;">
        <div class="nav">
            <button id="gallery-prev">‚óÄ</button>
            <button id="gallery-next">‚ñ∂</button>
        </div>
    </div>

    <a-scene
        mindar-image="imageTargetSrc: https://lessa2332.github.io/my-ar-vizytka/assets/targets/mycard.mind; autoStart: true; maxTrack: 1;"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false"
        loading-screen="enabled: false"
        embedded
        renderer="colorManagement: true; physicallyCorrectLights: false;"
        id="scene"
    >
        <!-- –û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è -->
        <a-entity light="type: directional; color: #FFF; intensity: 2.0" position="0 1 1"></a-entity>
        <a-entity light="type: ambient; color: #FFF; intensity: 0.8"></a-entity>

        <a-assets timeout="30000">
            <img id="photo-texture" src="https://lessa2332.github.io/my-ar-vizytka/assets/images/photo.jpg"> <!-- –î–æ–¥–∞–Ω–æ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ñ–æ—Ç–æ -->
            <video id="lesa-video" src="https://lessa2332.github.io/my-ar-vizytka/assets/video/lesa.mp4" preload="auto" loop="false"></video>
            <img id="youtube-icon" src="https://lessa2332.github.io/my-ar-vizytka/assets/icons/youtube.png">
            <img id="telegram-icon" src="https://lessa2332.github.io/my-ar-vizytka/assets/icons/telegram.png">
            <img id="googlesites-icon" src="https://lessa2332.github.io/my-ar-vizytka/assets/icons/googlesites.png">
            <img id="instagram-icon" src="https://lessa2332.github.io/my-ar-vizytka/assets/icons/instagram.png">
            <img id="play-icon" src="https://lessa2332.github.io/my-ar-vizytka/assets/icons/play.png"> <!-- ‚ñ∂Ô∏è –¥–ª—è –≤—ñ–¥–µ–æ -->
            <img id="game-icon" src="https://lessa2332.github.io/my-ar-vizytka/assets/icons/goy.png"> <!-- üéÆ –¥–ª—è –≥—Ä–∏ -->
            <img id="gallery-icon" src="https://lessa2332.github.io/my-ar-vizytka/assets/icons/play2.png"> <!-- üñºÔ∏è –¥–ª—è –≥–∞–ª–µ—Ä–µ—ó -->
            <!-- –§–æ—Ç–æ –¥–ª—è –≥–∞–ª–µ—Ä–µ—ó -->
            <img id="photo1" src="https://lessa2332.github.io/my-ar-vizytka/assets/images/photo1.jpg">
            <img id="photo2" src="https://lessa2332.github.io/my-ar-vizytka/assets/images/photo2.jpg">
            <img id="photo3" src="https://lessa2332.github.io/my-ar-vizytka/assets/images/photo3.jpg">
            <img id="photo4" src="https://lessa2332.github.io/my-ar-vizytka/assets/images/photo4.jpg">
        </a-assets>

        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera> <!-- –í–∏–º–∫–Ω–µ–Ω–æ look-controls –¥–ª—è –∫—Ä–∞—â–æ–≥–æ raycasting -->

        <a-entity mindar-image-target="targetIndex: 0">
            <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–µ —Ñ–æ—Ç–æ -->
            <a-image src="#photo-texture" position="0 0 -0.1" height="0.75" width="1.0" rotation="0 0 0"></a-image>
            
            <!-- –ë—ñ–≥—É—á–∞ —Å—Ç—Ä—ñ—á–∫–∞ -->
            <a-entity
                id="ticker"
                position="0 -0.2 0.05"
                text="value: –ù–∞–≤—á–∞—é –∑ –ª—é–±–æ–≤‚Äô—é ‚Ä¢ AR-–∫–≤–µ—Å—Ç–∏ ‚Äî —Ü–µ –Ω–æ–≤–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –Ω–∞–≤—á–∞–Ω–Ω—è! ‚Ä¢ –ü—Ä–æ—Å—Ç—ñ—Ä —ñ–Ω–Ω–æ–≤–∞—Ü—ñ–π–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≤–∞–≥! ‚Ä¢ 85% –¥—ñ—Ç–µ–π –∫—Ä–∞—â–µ –∑–∞—Å–≤–æ—é—é—Ç—å –º–∞—Ç–µ—Ä—ñ–∞–ª —á–µ—Ä–µ–∑ –≥—Ä—É! ‚Ä¢ –†–æ–∑–≤–∞–∂–∞–ª—å–Ω—ñ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ –ø—Ä–æ—î–∫—Ç–∏; align: left; width: 12; color: #FF4500; font: https://cdn.jsdelivr.net/gh/aframevr/aframe@master/src/style/fonts/Roboto-msdf.json; negate: false; shader: msdf; letterSpacing: -2"
                scale="1.0 1.0 1.0">
                <a-animation
                    attribute="position"
                    from="-5 -0.2 0.05"
                    to="5 -0.2 0.05"
                    dur="14000"
                    easing="linear"
                    repeat="indefinite"
                    fill="forwards">
                </a-animation>
            </a-entity>

            <!-- –í–µ—Ä—Ö–Ω—ñ–π —Ä—è–¥ –∫–Ω–æ–ø–æ–∫ -->
            <a-plane id="instagram-btn" class="clickable" width="0.15" height="0.15" position="-0.4 0.45 0.05" rotation="0 0 0" material="src: #instagram-icon; transparent: true; opacity: 1;" aria-label="Instagram ‚Äî —Ñ–æ—Ç–æ —Ç–∞ —Å—Ç–æ—Ä—ñ—Å –ø—Ä–æ AR-–ø—Ä–æ—î–∫—Ç–∏"></a-plane>
            <a-plane id="youtube-btn" class="clickable" width="0.15" height="0.15" position="-0.15 0.45 0.05" rotation="0 0 0" material="src: #youtube-icon; transparent: true; opacity: 1;" aria-label="QuestARia ‚Äì –∫–≤–µ—Å—Ç–∏, —â–æ –æ–∂–∏–≤–∞—é—Ç—å —É —Ç–≤–æ—î–º—É —Å–º–∞—Ä—Ç—Ñ–æ–Ω—ñ!"></a-plane>
            <a-plane id="telegram-btn" class="clickable" width="0.15" height="0.15" position="0.15 0.45 0.05" rotation="0 0 0" material="src: #telegram-icon; transparent: true; opacity: 1;" aria-label="AR_HUB ‚Äî –ø—Ä–æ—Å—Ç—ñ—Ä —ñ–Ω–Ω–æ–≤–∞—Ü—ñ–π–Ω–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≤–∞–≥!"></a-plane>
            <a-plane id="google-btn" class="clickable" width="0.15" height="0.15" position="0.4 0.45 0.05" rotation="0 0 0" material="src: #googlesites-icon; transparent: true; opacity: 1;" aria-label="QuestARia ‚Äì –∫–≤–µ—Å—Ç–∏, —â–æ –æ–∂–∏–≤–∞—é—Ç—å —É —Ç–≤–æ—î–º—É —Å–º–∞—Ä—Ç—Ñ–æ–Ω—ñ!"></a-plane>
            
            <!-- –ù–∏–∂–Ω—ñ–π —Ä—è–¥ –∫–Ω–æ–ø–æ–∫ -- –Ω–∞–±–ª–∏–∂–µ–Ω–æ –¥–æ —Ü–µ–Ω—Ç—Ä—É (x –∑–º–µ–Ω—à–µ–Ω–æ), –ø—ñ–¥–Ω—è—Ç–æ –±–ª–∏–∂—á–µ –ø—ñ–¥ —Ñ–æ—Ç–æ (y=-0.35) -->
            <a-plane id="play-video-btn" class="clickable" width="0.15" height="0.15" position="-0.3 -0.35 0.15" rotation="0 0 0" material="src: #play-icon; transparent: true; opacity: 1;" aria-label="–í—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ–¥–µ–æ"></a-plane>
            <a-plane id="game-btn" class="clickable" width="0.15" height="0.15" position="0.0 -0.35 0.15" rotation="0 0 0" material="src: #game-icon; transparent: true; opacity: 1;" aria-label="–†–æ–∑–ø–æ—á–∞—Ç–∏ –æ—Å–≤—ñ—Ç–Ω—é –≥—Ä—É"></a-plane>
            <a-plane id="gallery-btn" class="clickable" width="0.15" height="0.15" position="0.3 -0.35 0.15" rotation="0 0 0" material="src: #gallery-icon; transparent: true; opacity: 1;" aria-label="–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≥–∞–ª–µ—Ä–µ—é —Ñ–æ—Ç–æ"></a-plane>

            <!-- –ü—ñ–¥–ø–∏—Å–∏ –ø—ñ–¥ –∫–Ω–æ–ø–∫–∞–º–∏ -- –æ–Ω–æ–≤–ª–µ–Ω–æ y=-0.5 -->
            <a-text value="–í—ñ–¥–µ–æ" position="-0.3 -0.5 0.16" color="#FFF" align="center" scale="0.5 0.5 0.5"></a-text>
            <a-text value="–ì—Ä–∞" position="0 -0.5 0.16" color="#FFF" align="center" scale="0.5 0.5 0.5"></a-text>
            <a-text value="–ì–∞–ª–µ—Ä–µ—è" position="0.3 -0.5 0.16" color="#FFF" align="center" scale="0.5 0.5 0.5"></a-text>

            <!-- –í—ñ–¥–µ–æ -->
            <a-video 
                id="ar-video" 
                src="#lesa-video" 
                position="0 -0.5 0.1" 
                width="1.6" 
                height="0.9" 
                visible="false">
            </a-video>
        </a-entity>
    </a-scene>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const loader = document.getElementById('loader');
            const sceneEl = document.querySelector('a-scene');
            const targetEntity = document.querySelector('[mindar-image-target]');
            const arVideoEl = document.getElementById('ar-video');
            const playVideoBtn = document.getElementById('play-video-btn');
            const gameBtn = document.getElementById('game-btn');
            const galleryBtn = document.getElementById('gallery-btn');
            const quizContainer = document.getElementById('quiz-container');
            const quizQuestionEl = document.getElementById('quiz-question');
            const quizOptionsEl = document.getElementById('quiz-options');
            const quizResultEl = document.getElementById('quiz-result');
            const closeQuizBtn = document.getElementById('close-quiz');
            const galleryUI = document.getElementById('gallery-ui');
            const galleryImg = document.getElementById('gallery-img');
            const galleryCounter = document.getElementById('gallery-counter');
            const galleryPrev = document.getElementById('gallery-prev');
            const galleryNext = document.getElementById('gallery-next');
            const closeGalleryUI = document.getElementById('close-gallery-ui');

            // üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
            if (!playVideoBtn) console.error('‚ùó –ö–Ω–æ–ø–∫–∞ –≤—ñ–¥–µ–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞!');
            if (!gameBtn) console.error('‚ùó –ö–Ω–æ–ø–∫–∞ –≥—Ä–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞!');
            if (!galleryBtn) console.error('‚ùó –ö–Ω–æ–ø–∫–∞ –≥–∞–ª–µ—Ä–µ—ó –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞!');

            let isQuizActive = false;
            let isVideoPlaying = false;
            let currentQuestionIndex = 0;
            let currentPhotoIndex = 0;
            const totalPhotos = 4;
            const photoIds = ['photo1', 'photo2', 'photo3', 'photo4'];

            const quizData = [
                { question: "–Ø–∫–µ –º—ñ—Å—Ç–æ —î —Å—Ç–æ–ª–∏—Ü–µ—é –£–∫—Ä–∞—ó–Ω–∏?", options: ["–õ—å–≤—ñ–≤", "–û–¥–µ—Å–∞", "–ö–∏—ó–≤", "–•–∞—Ä–∫—ñ–≤"], answer: "–ö–∏—ó–≤" },
                { question: "–Ø–∫ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è –≥–æ–ª–æ–≤–Ω–∞ —Ä—ñ—á–∫–∞ –£–∫—Ä–∞—ó–Ω–∏?", options: ["–î–Ω—ñ—Å—Ç–µ—Ä", "–î–Ω—ñ–ø—Ä–æ", "–î–µ—Å–Ω–∞", "–î—É–Ω–∞–π"], answer: "–î–Ω—ñ–ø—Ä–æ" },
                { question: "–ù–∞–π–≤–∏—â–∞ –≥–æ—Ä–∞ –£–∫—Ä–∞—ó–Ω–∏ ‚Äî —Ü–µ?", options: ["–ü–µ—Ç—Ä–æ—Å", "–ì–æ–≤–µ—Ä–ª–∞", "–ü—ñ–ø –Ü–≤–∞–Ω"], answer: "–ì–æ–≤–µ—Ä–ª–∞" },
                { question: "–°–∫—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∏—Ö –æ–±–ª–∞—Å—Ç–µ–π –º–∞—î –£–∫—Ä–∞—ó–Ω–∞?", options: ["22", "24", "25"], answer: "24" },
                { question: "–°–∫—ñ–ª—å–∫–∏ –º–æ—Ä—ñ–≤ –æ–º–∏–≤–∞—î –£–∫—Ä–∞—ó–Ω—É?", options: ["–û–¥–Ω–µ", "–î–≤–∞", "–¢—Ä–∏"], answer: "–î–≤–∞" }
            ];

            // –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ MindAR
            sceneEl.addEventListener('arError', (err) => {
                console.error('–ü–æ–º–∏–ª–∫–∞ MindAR:', err);
                alert('–ù–µ –≤–¥–∞–ª–æ—Å—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ AR. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –º–∞—Ä–∫–µ—Ä –∞–±–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è.');
            });

            function startQuiz() {
                if (isQuizActive) return;
                isQuizActive = true;
                currentQuestionIndex = 0;
                quizContainer.style.display = 'block';
                showQuestion();
            }

            function showQuestion() {
                const currentQuestion = quizData[currentQuestionIndex];
                quizQuestionEl.textContent = currentQuestion.question;
                quizOptionsEl.innerHTML = '';
                quizResultEl.textContent = '';
                currentQuestion.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.setAttribute('aria-label', `–í–∞—Ä—ñ–∞–Ω—Ç: ${option}`);
                    button.addEventListener('click', () => checkAnswer(option));
                    quizOptionsEl.appendChild(button);
                });
            }

            function checkAnswer(selectedOption) {
                const currentQuestion = quizData[currentQuestionIndex];
                const isCorrect = selectedOption === currentQuestion.answer;
                
                Array.from(quizOptionsEl.children).forEach(button => {
                    button.disabled = true;
                    if (button.textContent === currentQuestion.answer) {
                        button.classList.add('correct');
                    } else if (button.textContent === selectedOption) {
                        button.classList.add('incorrect');
                    }
                });

                if (isCorrect) {
                    quizResultEl.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úÖ';
                    setTimeout(() => {
                        currentQuestionIndex++;
                        if (currentQuestionIndex < quizData.length) {
                            showQuestion();
                        } else {
                            quizResultEl.textContent = '–í—ñ–∫—Ç–æ—Ä–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ú–æ–ª–æ–¥–µ—Ü—å! üèÜ';
                            setTimeout(() => {
                                quizContainer.style.display = 'none';
                                isQuizActive = false;
                                currentQuestionIndex = 0;
                            }, 2000);
                        }
                    }, 1500);
                } else {
                    quizResultEl.textContent = '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑. ‚ùå';
                    setTimeout(() => {
                        quizResultEl.textContent = '';
                        Array.from(quizOptionsEl.children).forEach(button => {
                            button.disabled = false;
                            button.classList.remove('correct', 'incorrect');
                        });
                    }, 1500);
                }
            }

            closeQuizBtn.addEventListener('click', () => {
                quizContainer.style.display = 'none';
                isQuizActive = false;
                currentQuestionIndex = 0;
            });

            const links = {
                'youtube-btn': 'https://www.youtube.com/@23SmartLessa32',
                'telegram-btn': 'https://t.me/+Ck0ua_cmlI84Yjcy',
                'google-btn': 'https://sites.google.com/view/questaria/%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BD%D0%B0',
                'instagram-btn': 'https://www.instagram.com/smart23lessa?igsh=aHN5dzZudnJneW85'
            };

            Object.keys(links).forEach(id => {
                const btn = document.getElementById(id);
                if (btn) btn.addEventListener('click', () => window.open(links[id], '_blank', 'noopener,noreferrer'));
            });

            if (playVideoBtn) {
                playVideoBtn.addEventListener('click', () => {
                    if (isVideoPlaying) return;
                    console.log("üé¨ –ö–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ –í–Ü–î–ï–û");
                    isVideoPlaying = true;
                    arVideoEl.setAttribute('visible', true);
                    arVideoEl.setAttribute('position', '0 -0.5 0.1');
                    arVideoEl.setAttribute('animation__appear', {
                        property: 'position',
                        to: '0 1.2 0.1',
                        dur: 700,
                        easing: 'easeOutCubic',
                        delay: 200
                    });
                    const videoElement = arVideoEl.components.material.material.map.image;
                    if (videoElement && typeof videoElement.play === 'function') {
                        setTimeout(() => {
                            videoElement.play().catch(err => console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–µ–æ:', err));
                        }, 200);
                        videoElement.onended = () => {
                            arVideoEl.setAttribute('animation__disappear', {
                                property: 'position',
                                to: '0 -0.5 0.1',
                                dur: 500,
                                easing: 'easeInQuad'
                            });
                            setTimeout(() => {
                                arVideoEl.setAttribute('visible', false);
                                isVideoPlaying = false;
                            }, 500);
                        };
                    } else {
                        isVideoPlaying = false;
                    }
                });
            }

            if (gameBtn) {
                gameBtn.addEventListener('click', () => {
                    console.log("üéÆ –ö–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ –ì–†–ê");
                    startQuiz();
                });
            }

            if (galleryBtn) {
                galleryBtn.addEventListener('click', () => {
                    console.log("üñºÔ∏è –ö–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ –ì–ê–õ–ï–†–ï–Ø");
                    showGalleryPhoto(0);
                    galleryUI.style.display = 'block';
                });
            }

            function showGalleryPhoto(index) {
                currentPhotoIndex = index;
                const imgElement = document.getElementById(photoIds[index]);
                if (!imgElement) {
                    console.error(`–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è ${photoIds[index]} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!`);
                    return;
                }
                galleryImg.src = imgElement.src;
                galleryCounter.textContent = `–§–æ—Ç–æ ${index + 1} –∑ ${totalPhotos}`;
            }

            if (galleryPrev) galleryPrev.addEventListener('click', () => { if (currentPhotoIndex > 0) showGalleryPhoto(currentPhotoIndex - 1); });
            if (galleryNext) galleryNext.addEventListener('click', () => { if (currentPhotoIndex < totalPhotos - 1) showGalleryPhoto(currentPhotoIndex + 1); });
            if (closeGalleryUI) closeGalleryUI.addEventListener('click', () => { galleryUI.style.display = 'none'; });

            let hasTargetBeenFound = false;
            if (targetEntity) {
                targetEntity.addEventListener('targetFound', () => {
                    console.log("üéØ –ú–∞—Ä–∫–µ—Ä –∑–Ω–∞–π–¥–µ–Ω–æ!");
                    hasTargetBeenFound = true;
                    loader.style.display = 'none';
                });
            }
            setTimeout(() => {
                if (loader.style.display !== 'none') {
                    console.log('‚ÑπÔ∏è –õ–æ–∞–¥–µ—Ä –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ –ø—Ä–∏–º—É—Å–æ–≤–æ.');
                    loader.style.display = 'none';
                }
            }, 4000);

            sceneEl.addEventListener('loaded', () => {
                const canvas = sceneEl.canvas;

                function getMouseRay(x, y) {
                    const mouse = new THREE.Vector2();
                    mouse.x = (x / window.innerWidth) * 2 - 1;
                    mouse.y = -(y / window.innerHeight) * 2 + 1;
                    const camera = sceneEl.camera;
                    const raycaster = new THREE.Raycaster();
                    raycaster.setFromCamera(mouse, camera);
                    return raycaster;
                }

                function handleClick(x, y, eventType = 'click') {
                    const raycaster = getMouseRay(x, y);
                    const targetElements = [playVideoBtn, gameBtn, galleryBtn].filter(el => el && el.getAttribute('visible') !== 'false');
                    const intersections = [];

                    targetElements.forEach(el => {
                        const mesh = el.getObject3D('mesh');
                        if (mesh) {
                            const intersects = raycaster.intersectObject(mesh, true);
                            if (intersects.length > 0) {
                                intersections.push({ el, distance: intersects[0].distance, id: el.id });
                            }
                        }
                    });

                    if (intersections.length > 0) {
                        intersections.sort((a, b) => a.distance - b.distance);
                        const closestEl = intersections[0].el;
                        console.log(`üéØ –ö–ª—ñ–∫ –Ω–∞ ${closestEl.id} (–≤—ñ–¥—Å—Ç–∞–Ω—å: ${intersections[0].distance.toFixed(2)})`);
                        closestEl.emit(eventType);
                    } else {
                        console.log('‚ùå –ö–ª—ñ–∫ –Ω–µ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–æ ‚Äî –∂–æ–¥–µ–Ω –µ–ª–µ–º–µ–Ω—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ');
                    }
                }

                canvas.addEventListener('touchstart', e => e.preventDefault(), { passive: false });
                canvas.addEventListener('touchend', e => {
                    e.preventDefault();
                    if (e.changedTouches.length > 0) {
                        const touch = e.changedTouches[0];
                        handleClick(touch.clientX, touch.clientY);
                    }
                }, { passive: false });

                canvas.addEventListener('click', e => handleClick(e.clientX, e.clientY));
                canvas.addEventListener('mouseup', e => handleClick(e.clientX, e.clientY, 'mouseup'));
            });
        });
    </script>
</body>
</html>

