<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="AR-–≤—ñ–∑–∏—Ç–∫–∞-–ø–æ—Ä—Ç—Ñ–æ–ª—ñ–æ">
    <title>üé®Smart Lessa AR-–≤—ñ–∑–∏—Ç–∫–∞</title>

    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">

    <style>
        html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }
        a-scene { width: 100% !important; height: 100% !important; position: fixed; top: 0; left: 0; }
        .arjs-loader {
            height: 100%; width: 100%; position: absolute; top: 0; left: 0;
            background: rgba(135, 206, 235, 0.9); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: #FF4500; font-size: 1.8em; text-align: center; padding: 20px; box-sizing: border-box;
            font-family: 'Comic Neue', 'Comic Sans MS', cursive, sans-serif;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .pulse { animation: pulse 1.5s infinite; }

        /* –°—Ç–∏–ª—ñ –¥–ª—è –≤—ñ–∫—Ç–æ—Ä–∏–Ω–∏ */
        .quiz-container {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            z-index: 10001; background: rgba(255, 255, 255, 0.95);
            border-radius: 15px; padding: 25px; max-width: 90%; text-align: center;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); font-family: 'Comic Neue', 'Comic Sans MS', cursive, sans-serif;
            display: none;
        }
        .quiz-question { font-size: 1.5em; margin-bottom: 20px; color: #333; }
        .quiz-options button {
            display: block; width: 100%; padding: 12px; margin-bottom: 10px;
            border: 2px solid #4CAF50; border-radius: 10px;
            background-color: #f0f0f0; cursor: pointer; font-size: 1.1em;
            transition: background-color 0.3s;
        }
        .quiz-options button:hover { background-color: #e0e0e0; }
        .quiz-options button.correct { background-color: #4CAF50; color: white; border-color: #4CAF50; }
        .quiz-options button.incorrect { background-color: #f44336; color: white; border-color: #f44336; }
        .quiz-result { margin-top: 20px; font-size: 1.3em; font-weight: bold; }
        #close-quiz {
            position: absolute; top: 10px; right: 10px; padding: 5px 10px;
            cursor: pointer; border: none; background: #f44336; color: white;
            border-radius: 5px; font-size: 1em;
        }
        @media (max-width: 400px) {
            .quiz-question { font-size: 1.2em; }
            .quiz-options button { font-size: 0.9em; padding: 8px; }
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–ª—ñ–∫–∞–±–µ–ª—å–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ */
        .clickable {
            cursor: pointer;
        }
        .clickable:hover {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="arjs-loader" id="loader">
        <div class="pulse">‚ú® Smart Lessa AR-–≤—ñ–∑–∏—Ç–∫–∞ ‚ú®</div>
        <div style="margin-top: 20px; font-size: 1.2em;">–ù–∞–≤–µ–¥—ñ—Ç—å –∫–∞–º–µ—Ä—É –Ω–∞ –≤—ñ–∑–∏—Ç–∫—É! üòä</div>
    </div>

    <div id="quiz-container" class="quiz-container">
        <button id="close-quiz" aria-label="–ó–∞–∫—Ä–∏—Ç–∏ –≤—ñ–∫—Ç–æ—Ä–∏–Ω—É">‚úñ –ó–∞–∫—Ä–∏—Ç–∏</button>
        <div class="quiz-question" id="quiz-question"></div>
        <div class="quiz-options" id="quiz-options"></div>
        <div class="quiz-result" id="quiz-result"></div>
    </div>

    <a-scene
        mindar-image="imageTargetSrc: ./targets/mycard.mind;"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false"
        loading-screen="enabled: false"
        embedded
        renderer="colorManagement: true; physicallyCorrectLights: true;"
    >
        <a-assets timeout="30000">
            <img id="photo-texture" src="./assets/images/photo.jpg">
            <video id="lesa-video" src="./assets/video/lesa.mp4" preload="auto" loop="false"></video>
            <img id="youtube-icon" src="./assets/icons/youtube.png">
            <img id="telegram-icon" src="./assets/icons/telegram.png">
            <img id="googlesites-icon" src="./assets/icons/googlesites.png">
            <img id="instagram-icon" src="./assets/icons/instagram.png">
            <img id="play-icon" src="./assets/icons/play.png">
            <img id="goy-icon" src="./assets/icons/goy.png">
        </a-assets>

        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

        <a-entity mindar-image-target="targetIndex: 0">
            <a-image src="#photo-texture" position="0 0 -0.1" height="1.0" width="0.75" rotation="0 0 0"></a-image>
            <a-plane id="youtube-btn" class="clickable" width="0.2" height="0.2" position="0.5 -0.5 0.05" rotation="0 0 0" material="src: #youtube-icon; transparent: true; opacity: 1;" aria-label="–í—ñ–¥–∫—Ä–∏—Ç–∏ YouTube –∫–∞–Ω–∞–ª"></a-plane>
            <a-plane id="telegram-btn" class="clickable" width="0.2" height="0.2" position="0.2 -0.5 0.05" rotation="0 0 0" material="src: #telegram-icon; transparent: true; opacity: 1;" aria-label="–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ Telegram"></a-plane>
            <a-plane id="google-btn" class="clickable" width="0.2" height="0.2" position="-0.1 -0.5 0.05" rotation="0 0 0" material="src: #googlesites-icon; transparent: true; opacity: 1;" aria-label="–í—ñ–¥–≤—ñ–¥–∞—Ç–∏ Google Sites"></a-plane>
            <a-plane id="instagram-btn" class="clickable" width="0.2" height="0.2" position="-0.4 -0.5 0.05" rotation="0 0 0" material="src: #instagram-icon; transparent: true; opacity: 1;" aria-label="–í—ñ–¥–∫—Ä–∏—Ç–∏ Instagram"></a-plane>
            <a-plane id="play-video-btn" class="clickable" width="0.2" height="0.2" position="-0.7 -0.5 0.05" rotation="0 0 0" material="src: #play-icon; transparent: true; opacity: 1;" aria-label="–í—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ–¥–µ–æ"></a-plane>
            <a-plane id="quiz-btn" class="clickable" width="0.2" height="0.2" position="-1.0 -0.5 0.05" rotation="0 0 0" material="src: #goy-icon; transparent: true; opacity: 1;" aria-label="–†–æ–∑–ø–æ—á–∞—Ç–∏ –≤—ñ–∫—Ç–æ—Ä–∏–Ω—É"></a-plane>
            <a-video id="ar-video" src="#lesa-video" position="0.8 0 0.05" width="1.6" height="0.9" visible=false></a-video>
        </a-entity>
    </a-scene>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const loader = document.getElementById('loader');
            const sceneEl = document.querySelector('a-scene');
            const targetEntity = document.querySelector('[mindar-image-target]');
            const arVideoEl = document.getElementById('ar-video');
            const playVideoBtn = document.getElementById('play-video-btn');
            const quizBtn = document.getElementById('quiz-btn');
            const quizContainer = document.getElementById('quiz-container');
            const quizQuestionEl = document.getElementById('quiz-question');
            const quizOptionsEl = document.getElementById('quiz-options');
            const quizResultEl = document.getElementById('quiz-result');
            const closeQuizBtn = document.getElementById('close-quiz');

            let isQuizActive = false;
            let currentQuestionIndex = 0;
            const quizData = [
                {
                    question: "–Ø–∫–µ –º—ñ—Å—Ç–æ —î —Å—Ç–æ–ª–∏—Ü–µ—é –£–∫—Ä–∞—ó–Ω–∏?",
                    options: ["–õ—å–≤—ñ–≤", "–û–¥–µ—Å–∞", "–ö–∏—ó–≤", "–•–∞—Ä–∫—ñ–≤"],
                    answer: "–ö–∏—ó–≤"
                },
                {
                    question: "–Ø–∫ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è –≥–æ–ª–æ–≤–Ω–∞ —Ä—ñ—á–∫–∞ –£–∫—Ä–∞—ó–Ω–∏?",
                    options: ["–î–Ω—ñ—Å—Ç–µ—Ä", "–î–Ω—ñ–ø—Ä–æ", "–î–µ—Å–Ω–∞", "–î—É–Ω–∞–π"],
                    answer: "–î–Ω—ñ–ø—Ä–æ"
                }
            ];

            // –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ MindAR
            sceneEl.addEventListener('arError', (err) => {
                console.error('–ü–æ–º–∏–ª–∫–∞ MindAR:', err);
                alert('–ù–µ –≤–¥–∞–ª–æ—Å—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ AR. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –º–∞—Ä–∫–µ—Ä –∞–±–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è. / Failed to initialize AR. Check the marker or connection.');
            });

            // –û–±—Ä–æ–±–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤—ñ–≤
            document.querySelector('a-assets').addEventListener('loaded', () => {
                console.log('–£—Å—ñ –∞–∫—Ç–∏–≤–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ —É—Å–ø—ñ—à–Ω–æ');
            });
            document.querySelector('a-assets').addEventListener('error', (err) => {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–∫—Ç–∏–≤—ñ–≤:', err);
                alert('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–µ—è–∫—ñ —Ä–µ—Å—É—Ä—Å–∏. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∞–±–æ —Ñ–∞–π–ª–∏. / Failed to load some resources. Check connection or files.');
            });

            // –õ–æ–≥—ñ–∫–∞ –≤—ñ–∫—Ç–æ—Ä–∏–Ω–∏
            function startQuiz() {
                isQuizActive = true;
                quizContainer.style.display = 'block';
                showQuestion();
            }

            function showQuestion() {
                const currentQuestion = quizData[currentQuestionIndex];
                quizQuestionEl.textContent = currentQuestion.question;
                quizOptionsEl.innerHTML = '';
                quizResultEl.textContent = '';
                currentQuestion.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    button.setAttribute('aria-label', `–í–∞—Ä—ñ–∞–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ: ${option}`);
                    button.addEventListener('click', () => checkAnswer(option));
                    quizOptionsEl.appendChild(button);
                });
            }

            function checkAnswer(selectedOption) {
                const currentQuestion = quizData[currentQuestionIndex];
                const isCorrect = selectedOption === currentQuestion.answer;
                
                Array.from(quizOptionsEl.children).forEach(button => {
                    button.disabled = true;
                    if (button.textContent === currentQuestion.answer) {
                        button.classList.add('correct');
                    } else if (button.textContent === selectedOption) {
                        button.classList.add('incorrect');
                    }
                });

                if (isCorrect) {
                    quizResultEl.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úÖ';
                    setTimeout(() => {
                        currentQuestionIndex++;
                        if (currentQuestionIndex < quizData.length) {
                            showQuestion();
                        } else {
                            quizResultEl.textContent = '–í—ñ–∫—Ç–æ—Ä–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ú–æ–ª–æ–¥–µ—Ü—å! üèÜ';
                            setTimeout(() => {
                                quizContainer.style.display = 'none';
                                isQuizActive = false;
                                currentQuestionIndex = 0; // –°–∫–∏–¥–∞—î–º–æ –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫—É
                            }, 2000);
                        }
                    }, 1500);
                } else {
                    quizResultEl.textContent = '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑. ‚ùå';
                    setTimeout(() => {
                        quizResultEl.textContent = '';
                        Array.from(quizOptionsEl.children).forEach(button => {
                            button.disabled = false;
                            button.classList.remove('correct', 'incorrect');
                        });
                    }, 1500);
                }
            }

            // –ó–∞–∫—Ä–∏—Ç—Ç—è –≤—ñ–∫—Ç–æ—Ä–∏–Ω–∏
            closeQuizBtn.addEventListener('click', () => {
                quizContainer.style.display = 'none';
                isQuizActive = false;
                currentQuestionIndex = 0;
            });

            // –û–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –ø–æ—Å–∏–ª–∞–Ω—å
            const links = {
                'youtube-btn': 'https://www.youtube.com/@23SmartLessa32',
                'telegram-btn': 'https://t.me/+Ck0ua_cmlI84Yjcy',
                'google-btn': 'https://sites.google.com/view/questaria/%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BD%D0%B0',
                'instagram-btn': 'https://www.instagram.com/smart23lessa?igsh=aHN5dzZudnJneW85'
            };

            Object.keys(links).forEach(id => {
                const el = document.getElementById(id);
                el.addEventListener('click', () => {
                    window.open(links[id], '_blank', 'noopener,noreferrer');
                });
            });

            // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –≤—ñ–¥–µ–æ
            playVideoBtn.addEventListener('click', () => {
                if (arVideoEl) {
                    arVideoEl.setAttribute('visible', true);
                    const videoElement = arVideoEl.components.material.material.map.image;
                    if (videoElement && typeof videoElement.play === 'function') {
                        videoElement.play().catch(err => {
                            console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ–¥–µ–æ:', err);
                            alert('–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ–¥–µ–æ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∞–±–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è. / Failed to play video. Check format or connection.');
                        });
                    }
                } else {
                    console.error('–í—ñ–¥–µ–æ–µ–ª–µ–º–µ–Ω—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!');
                    alert('–í—ñ–¥–µ–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–µ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä–µ—Å—É—Ä—Å–∏. / Video unavailable. Check resources.');
                }
            });

            // –õ–æ–≥—ñ–∫–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –º–∞—Ä–∫–µ—Ä–∞
            if (targetEntity) {
                targetEntity.addEventListener('targetFound', () => {
                    console.log("üéØ –ú–∞—Ä–∫–µ—Ä –∑–Ω–∞–π–¥–µ–Ω–æ!");
                    loader.style.display = 'none';
                    if (arVideoEl.getAttribute('visible')) {
                        const videoElement = arVideoEl.components.material.material.map.image;
                        if (videoElement && videoElement.paused) {
                            videoElement.play().catch(err => {
                                console.error('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ–¥–µ–æ:', err);
                            });
                        }
                    }
                });

                targetEntity.addEventListener('targetLost', () => {
                    console.log("‚ÑπÔ∏è –ú–∞—Ä–∫–µ—Ä –≤—Ç—Ä–∞—á–µ–Ω–æ.");
                    loader.style.display = 'flex';
                    if (arVideoEl) {
                        const videoElement = arVideoEl.components.material.material.map.image;
                        if (videoElement) {
                            videoElement.pause();
                            videoElement.currentTime = 0;
                        }
                        arVideoEl.setAttribute('visible', false);
                    }
                });
            } else {
                console.error('–ï–ª–µ–º–µ–Ω—Ç mindar-image-target –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!');
                alert('–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó AR. –ï–ª–µ–º–µ–Ω—Ç mindar-image-target –≤—ñ–¥—Å—É—Ç–Ω—ñ–π. / AR initialization error: mindar-image-target element not found.');
            }

            // –ó–∞–ø—É—Å–∫ –≤—ñ–∫—Ç–æ—Ä–∏–Ω–∏ –ø–æ –∫–ª—ñ–∫—É
            quizBtn.addEventListener('click', () => {
                if (!isQuizActive) {
                    startQuiz();
                }
            });
        });
    </script>
</body>
</html>
